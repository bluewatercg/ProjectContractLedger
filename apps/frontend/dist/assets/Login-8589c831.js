/* empty css                  *//* empty css                   *//* empty css                     *//* empty css                    *//* empty css                 */import{d as S,u as A,r as m,a as E,o as D,c as I,b as t,e as l,w as o,f as $,g as d,h as B,i as N,E as Z,j as h,k as j,l as K,m as O,t as U,n as p,p as T,q as G,s as H,v as J}from"./index-16731161.js";import{_ as Q}from"./_plugin-vue_export-helper-c27b6911.js";const W={class:"login-container"},X={class:"login-card"},Y={class:"remember-me"},ee={class:"login-footer"},le={class:"demo-info"},re=S({__name:"Login",setup(oe){const x=B(),k=N(),c=A(),V=m(),f=m(),_=m(!1),b=m(!1),g=m(!1),v=m(!1),u=E({username:"",password:""}),s=E({username:"",email:"",password:"",confirmPassword:"",full_name:"",phone:""}),q={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:50,message:"用户名长度在 3 到 50 个字符",trigger:"blur"},{pattern:/^[a-zA-Z0-9_]+$/,message:"用户名只能包含字母、数字和下划线",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"密码长度不能少于 6 个字符",trigger:"blur"}]},F={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:50,message:"用户名长度在 3 到 50 个字符",trigger:"blur"},{pattern:/^[a-zA-Z0-9_]+$/,message:"用户名只能包含字母、数字和下划线",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱地址",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:"blur"},{max:100,message:"邮箱地址长度不能超过 100 个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"密码长度不能少于 6 个字符",trigger:"blur"},{pattern:/^(?=.*[a-zA-Z])(?=.*\d)/,message:"密码必须包含字母和数字",trigger:"blur"}],confirmPassword:[{required:!0,message:"请确认密码",trigger:"blur"},{validator:(i,e,a)=>{e!==s.password?a(new Error("两次输入密码不一致")):a()},trigger:"blur"}],full_name:[{max:50,message:"姓名长度不能超过 50 个字符",trigger:"blur"}],phone:[{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号码",trigger:"blur"}]},C=()=>{u.username="admin",u.password="admin123",p.info("已填充演示账户信息")},y=async()=>{if(V.value)try{await V.value.validate(),_.value=!0,await c.login(u),v.value?localStorage.setItem("rememberMe","true"):localStorage.removeItem("rememberMe"),p.success("登录成功");const i=k.query.redirect;x.push(i||"/dashboard")}catch(i){console.error("Login failed:",i),p.error(i.message||"登录失败，请检查用户名和密码")}finally{_.value=!1}},z=async()=>{var i;if(f.value)try{await f.value.validate(),b.value=!0;const{confirmPassword:e,...a}=s;await c.register(a),p.success("注册成功，请登录"),g.value=!1,u.username=a.username,u.password="",Object.assign(s,{username:"",email:"",password:"",confirmPassword:"",full_name:"",phone:""}),(i=f.value)==null||i.resetFields()}catch(e){console.error("Register failed:",e),p.error(e.message||"注册失败，请检查输入信息")}finally{b.value=!1}};return D(()=>{if(localStorage.getItem("rememberMe")==="true"&&(v.value=!0),c.isAuthenticated){const e=k.query.redirect;x.push(e||"/dashboard")}}),(i,e)=>{const a=T,n=G,L=H,w=J,R=Z,M=h,P=j;return K(),I("div",W,[t("div",X,[e[17]||(e[17]=t("div",{class:"login-header"},[t("h1",{class:"login-title"},"客户合同管理系统"),t("p",{class:"login-subtitle"},"请登录您的账户")],-1)),l(R,{ref_key:"loginFormRef",ref:V,model:u,rules:q,class:"login-form",onSubmit:$(y,["prevent"])},{default:o(()=>[l(n,{prop:"username"},{default:o(()=>[l(a,{modelValue:u.username,"onUpdate:modelValue":e[0]||(e[0]=r=>u.username=r),placeholder:"用户名",size:"large","prefix-icon":"User"},null,8,["modelValue"])]),_:1}),l(n,{prop:"password"},{default:o(()=>[l(a,{modelValue:u.password,"onUpdate:modelValue":e[1]||(e[1]=r=>u.password=r),type:"password",placeholder:"密码",size:"large","prefix-icon":"Lock","show-password":"",onKeyup:O(y,["enter"])},null,8,["modelValue"])]),_:1}),l(n,null,{default:o(()=>[t("div",Y,[l(L,{modelValue:v.value,"onUpdate:modelValue":e[2]||(e[2]=r=>v.value=r)},{default:o(()=>e[12]||(e[12]=[d("记住登录状态")])),_:1,__:[12]},8,["modelValue"])])]),_:1}),l(n,null,{default:o(()=>[l(w,{type:"primary",size:"large",loading:_.value,class:"login-button",onClick:y},{default:o(()=>[d(U(_.value?"登录中...":"登录"),1)]),_:1},8,["loading"])]),_:1}),l(n,null,{default:o(()=>[l(w,{size:"large",class:"demo-button",onClick:C},{default:o(()=>e[13]||(e[13]=[d(" 使用演示账户 ")])),_:1,__:[13]})]),_:1})]),_:1},8,["model"]),t("div",ee,[t("p",null,[e[14]||(e[14]=d("还没有账户？")),t("a",{href:"#",onClick:e[3]||(e[3]=r=>g.value=!0)},"立即注册")]),t("div",le,[l(M,null,{default:o(()=>e[15]||(e[15]=[d("演示账户")])),_:1,__:[15]}),e[16]||(e[16]=t("p",{class:"demo-text"},[t("strong",null,"用户名:"),d(" admin"),t("br"),t("strong",null,"密码:"),d(" admin123 ")],-1))])])]),l(P,{modelValue:g.value,"onUpdate:modelValue":e[11]||(e[11]=r=>g.value=r),title:"用户注册",width:"400px"},{footer:o(()=>[l(w,{onClick:e[10]||(e[10]=r=>g.value=!1)},{default:o(()=>e[18]||(e[18]=[d("取消")])),_:1,__:[18]}),l(w,{type:"primary",loading:b.value,onClick:z},{default:o(()=>[d(U(b.value?"注册中...":"注册"),1)]),_:1},8,["loading"])]),default:o(()=>[l(R,{ref_key:"registerFormRef",ref:f,model:s,rules:F,"label-width":"80px"},{default:o(()=>[l(n,{label:"用户名",prop:"username"},{default:o(()=>[l(a,{modelValue:s.username,"onUpdate:modelValue":e[4]||(e[4]=r=>s.username=r)},null,8,["modelValue"])]),_:1}),l(n,{label:"邮箱",prop:"email"},{default:o(()=>[l(a,{modelValue:s.email,"onUpdate:modelValue":e[5]||(e[5]=r=>s.email=r),type:"email"},null,8,["modelValue"])]),_:1}),l(n,{label:"密码",prop:"password"},{default:o(()=>[l(a,{modelValue:s.password,"onUpdate:modelValue":e[6]||(e[6]=r=>s.password=r),type:"password","show-password":""},null,8,["modelValue"])]),_:1}),l(n,{label:"确认密码",prop:"confirmPassword"},{default:o(()=>[l(a,{modelValue:s.confirmPassword,"onUpdate:modelValue":e[7]||(e[7]=r=>s.confirmPassword=r),type:"password","show-password":""},null,8,["modelValue"])]),_:1}),l(n,{label:"姓名",prop:"full_name"},{default:o(()=>[l(a,{modelValue:s.full_name,"onUpdate:modelValue":e[8]||(e[8]=r=>s.full_name=r)},null,8,["modelValue"])]),_:1}),l(n,{label:"电话",prop:"phone"},{default:o(()=>[l(a,{modelValue:s.phone,"onUpdate:modelValue":e[9]||(e[9]=r=>s.phone=r)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}});const me=Q(re,[["__scopeId","data-v-e492c001"]]);export{me as default};
