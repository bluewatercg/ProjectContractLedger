/* empty css                  *//* empty css                   *//* empty css                      *//* empty css               *//* empty css                  *//* empty css                     *//* empty css                 *//* empty css                        *//* empty css                    */import"./el-tooltip-4ed993c7.js";import{d as R,r as s,o as j,c as A,b as i,e as a,w as l,N as Q,L as q,h as G,z as H,v as J,Q as K,R as W,S as X,P as Y,l as h,g as u,t as w,y as Z,n as tt,F as et,T as at,U as ot,O as lt}from"./index-94d61daa.js";import{c as z}from"./contract-8f668363.js";import{C as nt}from"./CustomerSelect-64654b33.js";import{_ as st}from"./_plugin-vue_export-helper-c27b6911.js";import"./customer-d37927e9.js";const rt={class:"page-container"},ct={class:"page-header"},it={class:"table-container"},ut={class:"table-toolbar"},pt={class:"table-search"},dt={class:"pagination-container"},mt=R({__name:"ContractList",setup(_t){const f=G(),_=s(!1),C=s([]),d=s(null),v=s(""),r=s(1),g=s(10),b=s(0),x=e=>new Intl.NumberFormat("zh-CN").format(e),E=e=>({draft:"info",active:"success",completed:"primary",cancelled:"danger"})[e]||"info",k=e=>({draft:"草稿",active:"执行中",completed:"已完成",cancelled:"已取消"})[e]||e,S=(e,t)=>{d.value=e,r.value=1,c()},c=async()=>{try{_.value=!0;const e=await z.getContracts({page:r.value,limit:g.value,customerId:d.value||void 0,status:v.value});e.success&&e.data&&(C.value=e.data.items,b.value=e.data.total)}catch(e){console.error("Failed to fetch contracts:",e)}finally{_.value=!1}},T=()=>{r.value=1,c()},V=()=>{r.value=1,c()},B=()=>{c()},F=e=>{f.push(`/contracts/${e}`)},M=e=>{f.push(`/contracts/${e}/edit`)},$=async e=>{try{await Z.confirm("确定要删除这个合同吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),(await z.deleteContract(e)).success&&(tt.success("删除成功"),c())}catch(t){t!=="cancel"&&console.error("Failed to delete contract:",t)}};return j(()=>{c()}),(e,t)=>{const N=H("Plus"),P=et,m=J,p=at,L=K,n=ot,U=lt,I=W,D=X,O=Y;return h(),A("div",rt,[i("div",ct,[t[6]||(t[6]=i("h2",{class:"page-title"},"合同管理",-1)),a(m,{type:"primary",onClick:t[0]||(t[0]=o=>e.$router.push("/contracts/create"))},{default:l(()=>[a(P,null,{default:l(()=>[a(N)]),_:1}),t[5]||(t[5]=u(" 新建合同 "))]),_:1,__:[5]})]),i("div",it,[i("div",ut,[i("div",pt,[a(nt,{modelValue:d.value,"onUpdate:modelValue":t[1]||(t[1]=o=>d.value=o),placeholder:"选择客户筛选（支持搜索）",width:"250px",onChange:S},null,8,["modelValue"]),a(L,{modelValue:v.value,"onUpdate:modelValue":t[2]||(t[2]=o=>v.value=o),placeholder:"状态筛选",style:{width:"120px"},onChange:T},{default:l(()=>[a(p,{label:"全部",value:""}),a(p,{label:"草稿",value:"draft"}),a(p,{label:"执行中",value:"active"}),a(p,{label:"已完成",value:"completed"}),a(p,{label:"已取消",value:"cancelled"})]),_:1},8,["modelValue"])])]),Q((h(),q(I,{data:C.value,style:{width:"100%"}},{default:l(()=>[a(n,{prop:"contract_number",label:"合同编号",width:"150"}),a(n,{prop:"title",label:"合同标题"}),a(n,{prop:"customer.name",label:"客户名称"}),a(n,{prop:"total_amount",label:"合同金额",width:"120"},{default:l(({row:o})=>[u(" ¥"+w(x(o.total_amount)),1)]),_:1}),a(n,{prop:"start_date",label:"开始日期",width:"120"}),a(n,{prop:"end_date",label:"结束日期",width:"120"}),a(n,{prop:"status",label:"状态",width:"100"},{default:l(({row:o})=>[a(U,{type:E(o.status)},{default:l(()=>[u(w(k(o.status)),1)]),_:2},1032,["type"])]),_:1}),a(n,{label:"操作",width:"200"},{default:l(({row:o})=>[a(m,{size:"small",onClick:y=>F(o.id)},{default:l(()=>t[7]||(t[7]=[u("查看")])),_:2,__:[7]},1032,["onClick"]),a(m,{size:"small",type:"primary",onClick:y=>M(o.id)},{default:l(()=>t[8]||(t[8]=[u("编辑")])),_:2,__:[8]},1032,["onClick"]),a(m,{size:"small",type:"danger",onClick:y=>$(o.id)},{default:l(()=>t[9]||(t[9]=[u("删除")])),_:2,__:[9]},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[O,_.value]]),i("div",dt,[a(D,{"current-page":r.value,"onUpdate:currentPage":t[3]||(t[3]=o=>r.value=o),"page-size":g.value,"onUpdate:pageSize":t[4]||(t[4]=o=>g.value=o),total:b.value,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:V,onCurrentChange:B},null,8,["current-page","page-size","total"])])])])}}});const Bt=st(mt,[["__scopeId","data-v-06c16dae"]]);export{Bt as default};
