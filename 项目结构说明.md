# 客户合同管理系统 - 项目结构说明

## 项目概述

本项目是基于Midway.js框架开发的客户合同管理系统，采用前后端分离架构，支持Docker容器化部署。

## 目录结构

```
ProjectContractLedger/
├── midway-backend/              # 后端服务 (Midway.js)
│   ├── src/                     # 源代码
│   │   ├── controller/          # 控制器
│   │   ├── service/             # 业务服务
│   │   ├── entity/              # 数据实体
│   │   ├── config/              # 配置文件
│   │   └── middleware/          # 中间件
│   ├── package.json             # 后端依赖配置
│   ├── yarn.lock               # 依赖锁定文件
│   └── tsconfig.json           # TypeScript配置
│
├── midway-frontend/             # 前端应用 (Vue.js)
│   ├── src/                     # 源代码
│   │   ├── components/          # Vue组件
│   │   ├── views/               # 页面视图
│   │   ├── router/              # 路由配置
│   │   ├── store/               # 状态管理
│   │   └── utils/               # 工具函数
│   ├── public/                  # 静态资源
│   ├── package.json             # 前端依赖配置
│   └── yarn.lock               # 依赖锁定文件
│
├── testing/                     # 测试相关文件 (新整理)
│   ├── docs/                    # 测试文档
│   │   ├── 测试使用说明.md      # 测试使用指南
│   │   └── 测试计划.md          # 详细测试计划
│   ├── backend/                 # 后端测试
│   │   ├── controller/          # 控制器测试
│   │   ├── jest.config.js       # Jest配置
│   │   └── test-compile.js      # 测试编译脚本
│   ├── frontend/                # 前端测试 (预留)
│   ├── integration/             # 集成测试 (预留)
│   ├── performance/             # 性能测试
│   │   └── performance-test.js  # 性能测试脚本
│   └── scripts/                 # 测试脚本
│       ├── test-login.js        # 登录功能测试
│       ├── test-docker-build.*  # Docker构建测试
│       └── generate_password_hash.js # 密码哈希生成工具
│
├── deployment/                  # 部署相关文件 (新增)
│   ├── 生产环境部署说明.md      # 详细部署指南
│   ├── docker-compose.production.yml # 生产环境Docker配置
│   ├── .env.production.template # 环境变量模板
│   └── deploy.sh               # 自动化部署脚本
│
├── design/                      # 设计文档
│   ├── prototypes/              # UI原型设计
│   ├── database/                # 数据库设计
│   └── Flowchart.md            # 业务流程图
│
├── scripts/                     # 项目脚本
│   ├── build.sh                # 构建脚本
│   ├── start-dev.sh            # 开发环境启动
│   └── performance-test.js     # 性能测试 (已移至testing/)
│
├── .github/                     # GitHub Actions配置
│   └── workflows/               # CI/CD工作流
│       ├── docker-build-push.yml # Docker构建和推送
│       └── test-build.yml      # 测试构建
│
├── database/                    # 数据库相关
│   ├── migrations/              # 数据库迁移文件
│   ├── seeds/                   # 初始数据
│   └── scripts/                # 数据库脚本
│
├── docs/                        # 项目文档
│   ├── api/                     # API文档
│   ├── user-guide/              # 用户指南
│   └── development/             # 开发文档
│
├── Dockerfile                   # Docker镜像构建文件
├── docker-compose.yml          # 开发环境Docker配置
├── package.json                # 项目根配置
├── README.md                   # 项目说明
├── 项目结构说明.md             # 本文档
└── 各种启动脚本.bat/.sh        # 快速启动脚本
```

## 主要模块说明

### 1. 后端服务 (midway-backend/)

基于Midway.js框架的Node.js后端服务：

- **控制器层**: 处理HTTP请求和响应
- **服务层**: 业务逻辑处理
- **实体层**: 数据模型定义
- **中间件**: 认证、日志、错误处理等
- **配置**: 数据库、JWT、CORS等配置

**主要功能模块**:
- 用户认证和授权
- 客户管理
- 合同管理
- 发票管理
- 付款管理
- 统计报表

### 2. 前端应用 (midway-frontend/)

基于Vue.js的单页面应用：

- **组件**: 可复用的UI组件
- **视图**: 页面级组件
- **路由**: 页面导航配置
- **状态管理**: Vuex状态管理
- **工具函数**: 通用工具和API调用

**主要页面**:
- 登录页面
- 仪表板
- 客户管理
- 合同管理
- 发票管理
- 付款管理
- 系统设置

### 3. 测试模块 (testing/)

统一的测试管理目录：

- **测试文档**: 测试计划和使用说明
- **后端测试**: Jest单元测试和集成测试
- **前端测试**: Vue组件测试（预留）
- **集成测试**: 端到端测试（预留）
- **性能测试**: 系统性能和负载测试
- **测试脚本**: 各种测试工具和脚本

### 4. 部署模块 (deployment/)

生产环境部署相关：

- **部署说明**: 详细的部署指南
- **Docker配置**: 生产环境容器编排
- **环境配置**: 生产环境变量模板
- **部署脚本**: 自动化部署工具

## 技术栈

### 后端技术栈
- **框架**: Midway.js 3.x
- **运行时**: Node.js 18.x
- **数据库**: MySQL 8.0
- **ORM**: TypeORM
- **认证**: JWT
- **文档**: Swagger
- **测试**: Jest

### 前端技术栈
- **框架**: Vue.js 3.x
- **构建工具**: Vite
- **UI库**: Element Plus
- **状态管理**: Pinia
- **路由**: Vue Router
- **HTTP客户端**: Axios
- **测试**: Vitest (预留)

### 部署技术栈
- **容器化**: Docker + Docker Compose
- **CI/CD**: GitHub Actions
- **反向代理**: Nginx
- **监控**: Prometheus + Grafana (可选)
- **文件存储**: MinIO

## 开发环境搭建

### 1. 环境要求
- Node.js 18.x 或更高版本
- Yarn 包管理器
- MySQL 8.0
- Docker (可选)

### 2. 快速启动
```bash
# 克隆项目
git clone <repository-url>
cd ProjectContractLedger

# 安装依赖
cd midway-backend && yarn install
cd ../midway-frontend && yarn install

# 配置数据库
cp midway-backend/src/config/config.local.ts.example midway-backend/src/config/config.local.ts
# 编辑配置文件

# 启动开发环境
./start-dev.bat  # Windows
./start-dev.sh   # Linux/macOS
```

### 3. 使用Docker
```bash
# 构建和启动
docker-compose up -d

# 查看日志
docker-compose logs -f
```

## 测试指南

### 1. 运行测试
```bash
# 后端测试
cd midway-backend
yarn test

# 性能测试
cd testing/performance
node performance-test.js

# 登录测试
cd testing/scripts
node test-login.js
```

### 2. 测试文档
详细的测试说明请参考：
- [测试使用说明](testing/docs/测试使用说明.md)
- [测试计划](testing/docs/测试计划.md)

## 部署指南

### 1. 生产环境部署
详细的部署说明请参考：
- [生产环境部署说明](deployment/生产环境部署说明.md)

### 2. 快速部署
```bash
# 使用自动化脚本
cd deployment
./deploy.sh --init    # 初始化环境
./deploy.sh --deploy  # 部署应用
./deploy.sh --status  # 查看状态
```

## 项目维护

### 1. 代码规范
- 使用ESLint和Prettier进行代码格式化
- 遵循TypeScript最佳实践
- 提交前运行测试

### 2. 版本管理
- 使用Git进行版本控制
- 遵循语义化版本规范
- 使用GitHub Actions进行CI/CD

### 3. 文档维护
- 及时更新API文档
- 保持README和项目文档同步
- 记录重要的变更和决策

## 联系方式

如有问题或建议，请：
1. 查看相关文档
2. 检查已知问题
3. 提交Issue或联系开发团队

---

**注意**: 本文档会随着项目发展持续更新，请定期查看最新版本。
