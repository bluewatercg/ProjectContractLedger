<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>客户合同管理系统 - 记录开票</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body class="bg-gray-50">
    <div class="min-h-screen flex">
        <!-- 侧边栏 -->
        <aside class="w-64 bg-blue-800 text-white p-4 hidden md:block">
            <div class="mb-8">
                <h1 class="text-xl font-bold">合同管理系统</h1>
                <p class="text-sm text-blue-200">单用户版</p>
            </div>
            
            <nav>
                <ul class="space-y-2">
                    <li>
                        <a href="dashboard.html" class="flex items-center p-2 rounded hover:bg-blue-700">
                            <i class="fas fa-tachometer-alt mr-3"></i>
                            <span>仪表盘</span>
                        </a>
                    </li>
                    <li>
                        <a href="customers.html" class="flex items-center p-2 rounded hover:bg-blue-700">
                            <i class="fas fa-users mr-3"></i>
                            <span>客户管理</span>
                        </a>
                    </li>
                    <li>
                        <a href="contracts.html" class="flex items-center p-2 rounded hover:bg-blue-700">
                            <i class="fas fa-file-contract mr-3"></i>
                            <span>合同管理</span>
                        </a>
                    </li>
                    <li>
                        <a href="invoices.html" class="flex items-center p-2 rounded bg-blue-700">
                            <i class="fas fa-file-invoice mr-3"></i>
                            <span>开票管理</span>
                        </a>
                    </li>
                    <li>
                        <a href="payments.html" class="flex items-center p-2 rounded hover:bg-blue-700">
                            <i class="fas fa-money-bill-wave mr-3"></i>
                            <span>到款管理</span>
                        </a>
                    </li>
                    <li>
                        <a href="notifications.html" class="flex items-center p-2 rounded hover:bg-blue-700">
                            <i class="fas fa-bell mr-3"></i>
                            <span>提醒中心</span>
                        </a>
                    </li>
                </ul>
            </nav>
        </aside>

        <!-- 主内容区 -->
        <div class="flex-1 flex flex-col overflow-hidden">
            <!-- 顶部导航 -->
            <header class="bg-white shadow-sm z-10">
                <div class="flex items-center justify-between p-4">
                    <div class="flex items-center md:hidden">
                        <button class="text-gray-500 focus:outline-none">
                            <i class="fas fa-bars"></i>
                        </button>
                    </div>
                    <div class="flex items-center">
                        <div class="relative">
                            <button class="flex items-center text-gray-500 focus:outline-none">
                                <i class="fas fa-bell mr-1"></i>
                                <span class="absolute top-0 right-0 h-2 w-2 bg-red-500 rounded-full"></span>
                            </button>
                        </div>
                        <div class="ml-4 relative">
                            <div class="flex items-center">
                                <img class="h-8 w-8 rounded-full" src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80" alt="用户头像">
                                <!-- 图片来源: Unsplash -->
                                <span class="ml-2 text-gray-700">John Doe</span>
                            </div>
                        </div>
                    </div>
                </div>
            </header>

            <!-- 页面内容 -->
            <main class="flex-1 overflow-y-auto p-4 md:p-6 bg-gray-50">
                <div class="mb-6">
                    <h1 class="text-2xl font-bold text-gray-800">记录开票</h1>
                    <p class="text-gray-600">为客户合同记录发票信息</p>
                </div>

                <!-- 表单 -->
                <div class="bg-white rounded-lg shadow-sm overflow-hidden p-6">
                    <form>
                        <!-- 基本信息 -->
                        <div class="mb-6">
                            <h2 class="text-lg font-semibold text-gray-800 mb-4 pb-2 border-b border-gray-200">基本信息</h2>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label for="invoice-number" class="block text-sm font-medium text-gray-700 mb-1">发票编号 <span class="text-red-500">*</span></label>
                                    <input type="text" id="invoice-number" name="invoice-number" value="FP-2023-0013" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                                    <p class="text-xs text-gray-500 mt-1">系统自动生成，可修改</p>
                                </div>
                                <div>
                                    <label for="invoice-date" class="block text-sm font-medium text-gray-700 mb-1">开票日期 <span class="text-red-500">*</span></label>
                                    <input type="date" id="invoice-date" name="invoice-date" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                                </div>
                                <div>
                                    <label for="contract" class="block text-sm font-medium text-gray-700 mb-1">关联合同 <span class="text-red-500">*</span></label>
                                    <select id="contract" name="contract" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                                        <option value="">请选择合同</option>
                                        <option value="1">HT-2023-0018 - 广州网络科技有限公司 (合同金额: ¥200,000)</option>
                                        <option value="2">HT-2023-0017 - 深圳电子科技有限公司 (合同金额: ¥150,000)</option>
                                        <option value="3">HT-2023-0016 - 北京数字科技有限公司 (合同金额: ¥120,000)</option>
                                        <option value="4">HT-2023-0015 - 上海科技有限公司 (合同金额: ¥120,000)</option>
                                    </select>
                                    <p class="text-xs text-gray-500 mt-1">该合同已开票金额: ¥60,000，剩余可开票金额: ¥60,000</p>
                                </div>
                                <div>
                                    <label for="invoice-type" class="block text-sm font-medium text-gray-700 mb-1">发票类型 <span class="text-red-500">*</span></label>
                                    <select id="invoice-type" name="invoice-type" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                                        <option value="">请选择类型</option>
                                        <option value="1">增值税专用发票</option>
                                        <option value="2">增值税普通发票</option>
                                        <option value="3">电子发票</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- 金额信息 -->
                        <div class="mb-6">
                            <h2 class="text-lg font-semibold text-gray-800 mb-4 pb-2 border-b border-gray-200">金额信息</h2>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                                <div>
                                    <label for="invoice-amount" class="block text-sm font-medium text-gray-700 mb-1">开票金额 (元) <span class="text-red-500">*</span></label>
                                    <input type="number" id="invoice-amount" name="invoice-amount" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                                </div>
                                <div>
                                    <label for="tax-rate" class="block text-sm font-medium text-gray-700 mb-1">税率 (%)</label>
                                    <input type="number" id="tax-rate" name="tax-rate" value="6" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                </div>
                                <div>
                                    <label for="tax-amount" class="block text-sm font-medium text-gray-700 mb-1">税额 (元)</label>
                                    <input type="number" id="tax-amount" name="tax-amount" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500" readonly>
                                    <p class="text-xs text-gray-500 mt-1">系统自动计算</p>
                                </div>
                            </div>
                        </div>

                        <!-- 发票信息 -->
                        <div class="mb-6">
                            <h2 class="text-lg font-semibold text-gray-800 mb-4 pb-2 border-b border-gray-200">发票信息</h2>
                            <div class="mb-4">
                                <label for="invoice-info" class="block text-sm font-medium text-gray-700 mb-1">选择开票信息 <span class="text-red-500">*</span></label>
                                <div class="relative">
                                    <select id="invoice-info" name="invoice-info" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                                        <option value="">请选择开票信息</option>
                                        <option value="1" selected>上海科技有限公司 (默认)</option>
                                        <option value="2">上海科技有限公司上海分公司</option>
                                        <option value="3">上海科技有限公司北京办事处</option>
                                    </select>
                                    <div class="absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none">
                                        <i class="fas fa-chevron-down text-gray-400"></i>
                                    </div>
                                </div>
                                <div class="flex justify-between mt-1">
                                    <p class="text-xs text-gray-500">选择客户的开票信息</p>
                                    <a href="customer-invoice-info.html" class="text-xs text-blue-600 hover:text-blue-800 flex items-center">
                                        <i class="fas fa-plus-circle mr-1"></i> 管理开票信息
                                    </a>
                                </div>
                            </div>
                            
                            <!-- 选中的开票信息预览 -->
                            <div class="bg-gray-50 p-4 rounded-lg mb-4 border border-gray-200">
                                <div class="flex justify-between items-center mb-2">
                                    <h3 class="font-medium text-gray-900">开票信息预览</h3>
                                    <span class="px-2 py-1 inline-flex text-xs leading-4 font-semibold rounded-full bg-green-100 text-green-800">默认</span>
                                </div>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-3 text-sm">
                                    <div>
                                        <span class="text-gray-500">发票抬头：</span>
                                        <span class="text-gray-800 font-medium">上海科技有限公司</span>
                                    </div>
                                    <div>
                                        <span class="text-gray-500">纳税人识别号：</span>
                                        <span class="text-gray-800 font-medium">91310000XXXXXXXX3B</span>
                                    </div>
                                    <div>
                                        <span class="text-gray-500">开户行及账号：</span>
                                        <span class="text-gray-800">中国银行上海分行 622848XXXXXXXXXX</span>
                                    </div>
                                    <div>
                                        <span class="text-gray-500">地址电话：</span>
                                        <span class="text-gray-800">上海市浦东新区张江高科技园区科苑路88号 021-88889999</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- 手动修改开票信息（可选） -->
                            <div class="mb-2">
                                <div class="flex items-center">
                                    <input type="checkbox" id="edit-invoice-info" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                                    <label for="edit-invoice-info" class="ml-2 block text-sm text-gray-900">手动修改开票信息（仅用于本次开票，不会修改客户的开票信息记录）</label>
                                </div>
                            </div>
                            
                            <!-- 手动编辑区域（默认隐藏） -->
                            <div id="manual-edit-area" class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-4 hidden border-t border-gray-200 pt-4">
                                <div>
                                    <label for="invoice-title" class="block text-sm font-medium text-gray-700 mb-1">发票抬头 <span class="text-red-500">*</span></label>
                                    <input type="text" id="invoice-title" name="invoice-title" value="上海科技有限公司" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                                </div>
                                <div>
                                    <label for="tax-number" class="block text-sm font-medium text-gray-700 mb-1">税号 <span class="text-red-500">*</span></label>
                                    <input type="text" id="tax-number" name="tax-number" value="91310000XXXXXXXX3B" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                                </div>
                                <div>
                                    <label for="bank-name" class="block text-sm font-medium text-gray-700 mb-1">开户银行</label>
                                    <input type="text" id="bank-name" name="bank-name" value="中国银行上海分行" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                </div>
                                <div>
                                    <label for="bank-account" class="block text-sm font-medium text-gray-700 mb-1">银行账号</label>
                                    <input type="text" id="bank-account" name="bank-account" value="622848XXXXXXXXXX" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                </div>
                                <div>
                                    <label for="address" class="block text-sm font-medium text-gray-700 mb-1">地址</label>
                                    <input type="text" id="address" name="address" value="上海市浦东新区张江高科技园区科苑路88号" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                </div>
                                <div>
                                    <label for="phone" class="block text-sm font-medium text-gray-700 mb-1">电话</label>
                                    <input type="text" id="phone" name="phone" value="021-88889999" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                </div>
                            </div>
                        </div>

                        <!-- 发票内容 -->
                        <div class="mb-6">
                            <h2 class="text-lg font-semibold text-gray-800 mb-4 pb-2 border-b border-gray-200">发票内容</h2>
                            <div class="mb-4">
                                <label for="invoice-content" class="block text-sm font-medium text-gray-700 mb-1">发票内容 <span class="text-red-500">*</span></label>
                                <input type="text" id="invoice-content" name="invoice-content" placeholder="例如：技术服务费、咨询服务费等" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                            </div>
                        </div>

                        <!-- 发票文件 -->
                        <div class="mb-6">
                            <h2 class="text-lg font-semibold text-gray-800 mb-4 pb-2 border-b border-gray-200">发票文件</h2>
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 mb-2">上传发票扫描件</label>
                                <div class="flex items-center justify-center w-full">
                                    <label for="invoice-file" class="flex flex-col items-center justify-center w-full h-32 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 hover:bg-gray-100">
                                        <div class="flex flex-col items-center justify-center pt-5 pb-6">
                                            <i class="fas fa-cloud-upload-alt text-gray-400 text-3xl mb-2"></i>
                                            <p class="mb-2 text-sm text-gray-500"><span class="font-semibold">点击上传</span> 或拖放文件</p>
                                            <p class="text-xs text-gray-500">支持 PDF, JPG, PNG (最大 5MB)</p>
                                        </div>
                                        <input id="invoice-file" type="file" class="hidden" />
                                    </label>
                                </div>
                            </div>
                        </div>

                        <!-- 备注 -->
                        <div class="mb-6">
                            <label for="notes" class="block text-sm font-medium text-gray-700 mb-1">备注</label>
                            <textarea id="notes" name="notes" rows="4" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"></textarea>
                        </div>

                        <!-- 按钮 -->
                        <div class="flex justify-end space-x-4">
                            <a href="invoices.html" class="px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                取消
                            </a>
                            <button type="submit" class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2">
                                保存
                            </button>
                        </div>
                    </form>
                </div>
            </main>
        </div>
    </div>

    <script>
        // 控制手动编辑开票信息区域的显示/隐藏
        document.addEventListener('DOMContentLoaded', function() {
            const editCheckbox = document.getElementById('edit-invoice-info');
            const manualEditArea = document.getElementById('manual-edit-area');
            const invoiceInfoSelect = document.getElementById('invoice-info');
            
            // 切换手动编辑区域的显示/隐藏
            editCheckbox.addEventListener('change', function() {
                if (this.checked) {
                    manualEditArea.classList.remove('hidden');
                } else {
                    manualEditArea.classList.add('hidden');
                }
            });
            
            // 当选择不同的开票信息时，更新预览区域
            invoiceInfoSelect.addEventListener('change', function() {
                // 这里可以通过AJAX获取选中的开票信息详情
                // 或者在前端预设不同选项对应的数据
                
                // 示例：如果选择了第二个选项，更新预览信息
                if (this.value === '2') {
                    // 更新预览区域的显示内容
                    document.querySelector('.bg-gray-50 .text-gray-800:nth-of-type(1)').textContent = '上海科技有限公司上海分公司';
                    document.querySelector('.bg-gray-50 .text-gray-800:nth-of-type(2)').textContent = '91310000XXXXXXXX4C';
                    document.querySelector('.bg-gray-50 .text-gray-800:nth-of-type(3)').textContent = '工商银行上海分行 621226XXXXXXXXXX';
                    document.querySelector('.bg-gray-50 .text-gray-800:nth-of-type(4)').textContent = '上海市静安区南京西路1266号 021-66667777';
                    
                    // 同时更新手动编辑区域的默认值
                    if (editCheckbox.checked) {
                        document.getElementById('invoice-title').value = '上海科技有限公司上海分公司';
                        document.getElementById('tax-number').value = '91310000XXXXXXXX4C';
                        document.getElementById('bank-name').value = '工商银行上海分行';
                        document.getElementById('bank-account').value = '621226XXXXXXXXXX';
                        document.getElementById('address').value = '上海市静安区南京西路1266号';
                        document.getElementById('phone').value = '021-66667777';
                    }
                } else if (this.value === '1') {
                    // 恢复默认值
                    document.querySelector('.bg-gray-50 .text-gray-800:nth-of-type(1)').textContent = '上海科技有限公司';
                    document.querySelector('.bg-gray-50 .text-gray-800:nth-of-type(2)').textContent = '91310000XXXXXXXX3B';
                    document.querySelector('.bg-gray-50 .text-gray-800:nth-of-type(3)').textContent = '中国银行上海分行 622848XXXXXXXXXX';
                    document.querySelector('.bg-gray-50 .text-gray-800:nth-of-type(4)').textContent = '上海市浦东新区张江高科技园区科苑路88号 021-88889999';
                    
                    // 同时更新手动编辑区域的默认值
                    if (editCheckbox.checked) {
                        document.getElementById('invoice-title').value = '上海科技有限公司';
                        document.getElementById('tax-number').value = '91310000XXXXXXXX3B';
                        document.getElementById('bank-name').value = '中国银行上海分行';
                        document.getElementById('bank-account').value = '622848XXXXXXXXXX';
                        document.getElementById('address').value = '上海市浦东新区张江高科技园区科苑路88号';
                        document.getElementById('phone').value = '021-88889999';
                    }
                }
            });
        });
    </script>
</body>
</html>