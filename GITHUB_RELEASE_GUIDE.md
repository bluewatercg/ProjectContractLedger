# GitHub æ„å»ºå‘å¸ƒæŒ‡å—

## ğŸš€ å¿«é€Ÿå‘å¸ƒ

### ä½¿ç”¨å‘å¸ƒè„šæœ¬ï¼ˆæ¨èï¼‰

#### Linux/macOS:
```bash
# ç»™è„šæœ¬æ‰§è¡Œæƒé™
chmod +x scripts/github-release.sh

# æ‰§è¡Œå®Œæ•´å‘å¸ƒæµç¨‹
./scripts/github-release.sh
```

#### Windows:
```powershell
# åœ¨ PowerShell ä¸­æ‰§è¡Œ
.\scripts\github-release.ps1
```

### æ‰‹åŠ¨å‘å¸ƒæµç¨‹

```bash
# 1. æ£€æŸ¥å¹¶æäº¤ä¿®å¤
git add .
git commit -m "fix: ä¿®å¤nginxä»£ç†é…ç½®å’ŒAPIè·¯å¾„é—®é¢˜"

# 2. æ¨é€åˆ°GitHub
git push origin main

# 3. åˆ›å»ºç‰ˆæœ¬æ ‡ç­¾ï¼ˆå¯é€‰ï¼‰
git tag -a v1.0.1 -m "Release v1.0.1 - ä¿®å¤nginxä»£ç†å’ŒAPIè·¯å¾„é—®é¢˜"
git push origin v1.0.1
```

## ğŸ“‹ GitHub Actions å·¥ä½œæµ

### ä¸»è¦å·¥ä½œæµæ–‡ä»¶

1. **`.github/workflows/docker-build-push.yml`** - ä¸»æ„å»ºå·¥ä½œæµ
   - è§¦å‘æ¡ä»¶ï¼šæ¨é€åˆ° main, master, develop, midwayjs åˆ†æ”¯
   - åŠŸèƒ½ï¼šæ„å»ºå’Œæ¨é€Dockeré•œåƒåˆ°GitHub Container Registry

2. **`.github/workflows/test-build.yml`** - æµ‹è¯•æ„å»ºå·¥ä½œæµ
   - è§¦å‘æ¡ä»¶ï¼šæ‰€æœ‰åˆ†æ”¯æ¨é€
   - åŠŸèƒ½ï¼šæµ‹è¯•æ„å»ºï¼ˆä¸æ¨é€é•œåƒï¼‰

3. **`.github/workflows/simple-test.yml`** - ç®€å•æµ‹è¯•å·¥ä½œæµ
   - è§¦å‘æ¡ä»¶ï¼šæ‰€æœ‰æ¨é€
   - åŠŸèƒ½ï¼šåŸºæœ¬ç¯å¢ƒæµ‹è¯•

### æ„å»ºè§¦å‘æ¡ä»¶

```yaml
# è‡ªåŠ¨è§¦å‘
on:
  push:
    branches: [ main, master, develop, midwayjs ]
    tags: [ 'v*' ]
  pull_request:
    branches: [ main, master, midwayjs ]

# æ‰‹åŠ¨è§¦å‘
  workflow_dispatch:
```

### é•œåƒæ ‡ç­¾è§„åˆ™

- **`latest`** - ä¸»åˆ†æ”¯æœ€æ–°ç‰ˆæœ¬
- **`main`**, **`develop`** - åˆ†æ”¯åç§°
- **`v1.0.0`** - ç‰ˆæœ¬æ ‡ç­¾
- **`main-sha123456`** - åˆ†æ”¯+æäº¤å“ˆå¸Œ

## ğŸ”§ æ„å»ºæµç¨‹è¯¦è§£

### é˜¶æ®µ1ï¼šæ„å»ºéªŒè¯
1. **ç¯å¢ƒå‡†å¤‡** - Node.js 18.x, Yarnç¼“å­˜
2. **ä¾èµ–å®‰è£…** - åç«¯å’Œå‰ç«¯ä¾èµ–
3. **ä»£ç æ£€æŸ¥** - ESLint, æ ¼å¼åŒ–
4. **æ„å»ºæµ‹è¯•** - åç«¯å’Œå‰ç«¯æ„å»º

### é˜¶æ®µ2ï¼šDockeræ„å»º
1. **å¤šé˜¶æ®µæ„å»º** - åç«¯æ„å»º â†’ å‰ç«¯æ„å»º â†’ ç”Ÿäº§é•œåƒ
2. **å¤šå¹³å°æ”¯æŒ** - linux/amd64, linux/arm64
3. **ç¼“å­˜ä¼˜åŒ–** - GitHub Actionsç¼“å­˜
4. **é•œåƒæ¨é€** - GitHub Container Registry

### é˜¶æ®µ3ï¼šå‘å¸ƒ
1. **é•œåƒæ ‡ç­¾** - è‡ªåŠ¨ç”Ÿæˆæ ‡ç­¾
2. **å…ƒæ•°æ®** - æ„å»ºä¿¡æ¯å’Œæ ‡ç­¾
3. **æ¨é€éªŒè¯** - ç¡®è®¤æ¨é€æˆåŠŸ

## ğŸ§ª éªŒè¯æ„å»º

### 1. æ£€æŸ¥GitHub ActionsçŠ¶æ€

è®¿é—®æ‚¨çš„GitHubä»“åº“çš„Actionsé¡µé¢ï¼š
```
https://github.com/your-username/your-repo/actions
```

### 2. éªŒè¯é•œåƒæ¨é€

æ£€æŸ¥GitHub Container Registryï¼š
```
https://github.com/your-username/your-repo/pkgs/container/your-repo
```

### 3. æœ¬åœ°æµ‹è¯•æ–°é•œåƒ

```bash
# æ‹‰å–æœ€æ–°é•œåƒ
docker pull ghcr.io/your-username/your-repo:latest

# æµ‹è¯•è¿è¡Œ
docker run -d --name test-container \
  -p 8000:80 -p 8080:8080 \
  ghcr.io/your-username/your-repo:latest
```

## ğŸš¨ æ•…éšœæ’é™¤

### å¸¸è§æ„å»ºé—®é¢˜

#### 1. æƒé™é”™è¯¯
```
Error: denied: permission_denied
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
- ç¡®ä¿ä»“åº“çš„Actionsæƒé™è®¾ç½®æ­£ç¡®
- æ£€æŸ¥GITHUB_TOKENæƒé™

#### 2. ä¾èµ–å®‰è£…å¤±è´¥
```
Error: yarn install failed
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
- æ£€æŸ¥package.jsonæ–‡ä»¶
- æ¸…ç†yarn.lockæ–‡ä»¶
- å¢åŠ ç½‘ç»œè¶…æ—¶æ—¶é—´

#### 3. æ„å»ºè¶…æ—¶
```
Error: The operation was canceled
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
- ä¼˜åŒ–æ„å»ºç¼“å­˜
- å‡å°‘æ„å»ºæ­¥éª¤
- ä½¿ç”¨æ›´å¿«çš„æ„å»ºæœºå™¨

### è°ƒè¯•æ–¹æ³•

#### 1. æŸ¥çœ‹æ„å»ºæ—¥å¿—
```bash
# åœ¨GitHub Actionsé¡µé¢æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
# æˆ–ä½¿ç”¨GitHub CLI
gh run list
gh run view <run-id>
```

#### 2. æœ¬åœ°å¤ç°æ„å»º
```bash
# ä½¿ç”¨ç›¸åŒçš„Dockerfileæœ¬åœ°æ„å»º
docker build -f tools/docker/Dockerfile -t test-build .
```

#### 3. æ£€æŸ¥å·¥ä½œæµé…ç½®
```bash
# éªŒè¯å·¥ä½œæµè¯­æ³•
./scripts/utils/check-github-actions.sh
```

## ğŸ“Š ç›‘æ§å’Œé€šçŸ¥

### æ„å»ºçŠ¶æ€å¾½ç« 

åœ¨README.mdä¸­æ·»åŠ æ„å»ºçŠ¶æ€å¾½ç« ï¼š

```markdown
![Build Status](https://github.com/your-username/your-repo/workflows/Build%20and%20Push%20Docker%20Images/badge.svg)
```

### é€šçŸ¥è®¾ç½®

åœ¨GitHubä»“åº“è®¾ç½®ä¸­é…ç½®ï¼š
1. **Notifications** â†’ **Actions**
2. é€‰æ‹©é€šçŸ¥ç±»å‹ï¼ˆå¤±è´¥ã€æˆåŠŸç­‰ï¼‰
3. é…ç½®é€šçŸ¥æ–¹å¼ï¼ˆé‚®ä»¶ã€Slackç­‰ï¼‰

## ğŸ¯ æœ€ä½³å®è·µ

### 1. åˆ†æ”¯ç­–ç•¥
- **main** - ç”Ÿäº§ç¯å¢ƒ
- **develop** - å¼€å‘ç¯å¢ƒ
- **feature/** - åŠŸèƒ½åˆ†æ”¯

### 2. ç‰ˆæœ¬ç®¡ç†
```bash
# è¯­ä¹‰åŒ–ç‰ˆæœ¬
v1.0.0  # ä¸»ç‰ˆæœ¬.æ¬¡ç‰ˆæœ¬.ä¿®è®¢ç‰ˆæœ¬
v1.0.1  # ä¿®å¤ç‰ˆæœ¬
v1.1.0  # åŠŸèƒ½ç‰ˆæœ¬
v2.0.0  # é‡å¤§æ›´æ–°
```

### 3. æäº¤ä¿¡æ¯è§„èŒƒ
```bash
# æ ¼å¼ï¼štype(scope): description
fix(nginx): ä¿®å¤ä»£ç†é…ç½®å¯¼è‡´çš„404é—®é¢˜
feat(auth): æ·»åŠ JWTè®¤è¯åŠŸèƒ½
docs(readme): æ›´æ–°éƒ¨ç½²æ–‡æ¡£
```

### 4. æ„å»ºä¼˜åŒ–
- ä½¿ç”¨å¤šé˜¶æ®µæ„å»ºå‡å°‘é•œåƒå¤§å°
- å¯ç”¨æ„å»ºç¼“å­˜æé«˜é€Ÿåº¦
- å¹¶è¡Œæ„å»ºå‰åç«¯

## ğŸ”„ æŒç»­é›†æˆæµç¨‹

```mermaid
graph LR
    A[ä»£ç æäº¤] --> B[GitHub Actionsè§¦å‘]
    B --> C[æ„å»ºéªŒè¯]
    C --> D[Dockeræ„å»º]
    D --> E[é•œåƒæ¨é€]
    E --> F[éƒ¨ç½²é€šçŸ¥]
    F --> G[ç”Ÿäº§éƒ¨ç½²]
```

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

### æ„å»ºæ—¶é—´ä¼˜åŒ–
1. **ç¼“å­˜ç­–ç•¥** - ä¾èµ–ç¼“å­˜ã€æ„å»ºç¼“å­˜
2. **å¹¶è¡Œæ„å»º** - å‰åç«¯å¹¶è¡Œæ„å»º
3. **å¢é‡æ„å»º** - åªæ„å»ºå˜æ›´éƒ¨åˆ†

### é•œåƒå¤§å°ä¼˜åŒ–
1. **å¤šé˜¶æ®µæ„å»º** - åˆ†ç¦»æ„å»ºå’Œè¿è¡Œç¯å¢ƒ
2. **AlpineåŸºç¡€é•œåƒ** - æ›´å°çš„åŸºç¡€é•œåƒ
3. **ä¾èµ–æ¸…ç†** - åˆ é™¤ä¸å¿…è¦çš„ä¾èµ–

## ğŸ‰ å‘å¸ƒæ£€æŸ¥æ¸…å•

- [ ] ä»£ç å·²æäº¤å¹¶æ¨é€
- [ ] GitHub Actionsæ„å»ºæˆåŠŸ
- [ ] é•œåƒå·²æ¨é€åˆ°Registry
- [ ] ç‰ˆæœ¬æ ‡ç­¾å·²åˆ›å»ºï¼ˆå¦‚é€‚ç”¨ï¼‰
- [ ] éƒ¨ç½²æ–‡æ¡£å·²æ›´æ–°
- [ ] ç”Ÿäº§ç¯å¢ƒå‡†å¤‡å°±ç»ª

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœé‡åˆ°æ„å»ºé—®é¢˜ï¼š

1. **æ£€æŸ¥æ„å»ºæ—¥å¿—** - GitHub Actionsé¡µé¢
2. **éªŒè¯é…ç½®æ–‡ä»¶** - å·¥ä½œæµYAMLæ–‡ä»¶
3. **æœ¬åœ°æµ‹è¯•** - å¤ç°æ„å»ºé—®é¢˜
4. **æŸ¥çœ‹æ–‡æ¡£** - GitHub Actionså®˜æ–¹æ–‡æ¡£
5. **ç¤¾åŒºæ”¯æŒ** - GitHub Discussionsæˆ–Issues
