/* empty css                  *//* empty css                   *//* empty css                        *//* empty css               *//* empty css                  *//* empty css                     *//* empty css                 *//* empty css                    */import"./el-tooltip-4ed993c7.js";import{d as R,r as s,o as j,c as A,b as u,e as a,w as n,N as Q,L as q,h as G,z as H,v as J,Q as K,R as W,S as X,P as Y,l as h,g as d,t as w,y as Z,n as ee,F as te,T as ae,U as oe,O as ne}from"./index-1e642474.js";import{i as z}from"./invoice-657a2ee3.js";import{C as le}from"./ContractSelect-051d8073.js";import{_ as se}from"./_plugin-vue_export-helper-c27b6911.js";import"./contract-f9d1be3d.js";const ie={class:"page-container"},re={class:"page-header"},ce={class:"table-container"},ue={class:"table-toolbar"},de={class:"table-search"},pe={class:"pagination-container"},ve=R({__name:"InvoiceList",setup(_e){const f=G(),_=s(!1),b=s([]),p=s(null),m=s(""),i=s(1),g=s(10),C=s(0),I=t=>new Intl.NumberFormat("zh-CN").format(t),x=t=>({draft:"",sent:"warning",paid:"success",overdue:"danger",cancelled:"info"})[t]||"",E=t=>({draft:"草稿",sent:"已发送",paid:"已支付",overdue:"逾期",cancelled:"已取消"})[t]||t,r=async()=>{try{_.value=!0;const t=await z.getInvoices({page:i.value,limit:g.value,contractId:p.value||void 0,status:m.value});t.success&&t.data&&(b.value=t.data.items,C.value=t.data.total)}catch(t){console.error("Failed to fetch invoices:",t)}finally{_.value=!1}},k=(t,e)=>{p.value=t,i.value=1,r()},S=()=>{i.value=1,r()},T=()=>{i.value=1,r()},V=()=>{r()},B=t=>{f.push(`/invoices/${t}`)},F=t=>{f.push(`/invoices/${t}/edit`)},M=async t=>{try{await Z.confirm("确定要删除这张发票吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),(await z.deleteInvoice(t)).success&&(ee.success("删除成功"),r())}catch(e){e!=="cancel"&&console.error("Failed to delete invoice:",e)}};return j(()=>{r()}),(t,e)=>{const $=H("Plus"),N=te,v=J,c=ae,P=K,l=oe,L=ne,U=W,D=X,O=Y;return h(),A("div",ie,[u("div",re,[e[6]||(e[6]=u("h2",{class:"page-title"},"发票管理",-1)),a(v,{type:"primary",onClick:e[0]||(e[0]=o=>t.$router.push("/invoices/create"))},{default:n(()=>[a(N,null,{default:n(()=>[a($)]),_:1}),e[5]||(e[5]=d(" 新建发票 "))]),_:1,__:[5]})]),u("div",ce,[u("div",ue,[u("div",de,[a(le,{modelValue:p.value,"onUpdate:modelValue":e[1]||(e[1]=o=>p.value=o),placeholder:"选择合同筛选（支持搜索）",width:"250px",onChange:k},null,8,["modelValue"]),a(P,{modelValue:m.value,"onUpdate:modelValue":e[2]||(e[2]=o=>m.value=o),placeholder:"状态筛选",style:{width:"120px"},onChange:S},{default:n(()=>[a(c,{label:"全部",value:""}),a(c,{label:"草稿",value:"draft"}),a(c,{label:"已发送",value:"sent"}),a(c,{label:"已支付",value:"paid"}),a(c,{label:"逾期",value:"overdue"}),a(c,{label:"已取消",value:"cancelled"})]),_:1},8,["modelValue"])])]),Q((h(),q(U,{data:b.value,style:{width:"100%"}},{default:n(()=>[a(l,{prop:"invoice_number",label:"发票编号",width:"150"}),a(l,{prop:"contract.title",label:"合同标题"}),a(l,{prop:"contract.customer.name",label:"客户名称"}),a(l,{prop:"total_amount",label:"发票金额",width:"120"},{default:n(({row:o})=>[d(" ¥"+w(I(o.total_amount)),1)]),_:1}),a(l,{prop:"issue_date",label:"开票日期",width:"120"}),a(l,{prop:"status",label:"状态",width:"100"},{default:n(({row:o})=>[a(L,{type:x(o.status)},{default:n(()=>[d(w(E(o.status)),1)]),_:2},1032,["type"])]),_:1}),a(l,{label:"操作",width:"200"},{default:n(({row:o})=>[a(v,{size:"small",onClick:y=>B(o.id)},{default:n(()=>e[7]||(e[7]=[d("查看")])),_:2,__:[7]},1032,["onClick"]),a(v,{size:"small",type:"primary",onClick:y=>F(o.id)},{default:n(()=>e[8]||(e[8]=[d("编辑")])),_:2,__:[8]},1032,["onClick"]),a(v,{size:"small",type:"danger",onClick:y=>M(o.id)},{default:n(()=>e[9]||(e[9]=[d("删除")])),_:2,__:[9]},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[O,_.value]]),u("div",pe,[a(D,{"current-page":i.value,"onUpdate:currentPage":e[3]||(e[3]=o=>i.value=o),"page-size":g.value,"onUpdate:pageSize":e[4]||(e[4]=o=>g.value=o),total:C.value,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:T,onCurrentChange:V},null,8,["current-page","page-size","total"])])])])}}});const Te=se(ve,[["__scopeId","data-v-0f9b0d76"]]);export{Te as default};
