/* empty css                  *//* empty css                   *//* empty css                     *//* empty css                 */import{d as N,r as c,x as g,a as I,o as R,c as q,b as m,t as k,N as D,L,w as s,h as M,i as S,n as y,E as j,P as A,l as x,e as l,g as h,p as O,q as P,v as T}from"./index-1e642474.js";import{c as f}from"./customer-5d58a403.js";const z={class:"page-container"},G={class:"page-header"},H={class:"page-title"},J={class:"form-container"},K={class:"form-actions"},ae=N({__name:"CustomerForm",setup(Q){const _=M(),b=S(),p=c(),i=c(!1),d=c(!1),u=g(()=>!!b.params.id),V=g(()=>Number(b.params.id)),e=I({name:"",contact_person:"",phone:"",email:"",address:"",tax_number:"",bank_account:"",bank_name:"",notes:""}),w={name:[{required:!0,message:"请输入客户名称",trigger:"blur"}],email:[{type:"email",message:"请输入正确的邮箱地址",trigger:"blur"}]},C=async()=>{if(u.value)try{i.value=!0;const t=await f.getCustomerById(V.value);t.success&&t.data&&Object.assign(e,t.data)}catch(t){console.error("Failed to fetch customer:",t),y.error("获取客户信息失败")}finally{i.value=!1}},U=async()=>{if(p.value)try{await p.value.validate(),d.value=!0;let t;u.value?t=await f.updateCustomer(V.value,e):t=await f.createCustomer(e),t.success&&(y.success(u.value?"更新成功":"创建成功"),_.push("/customers"))}catch(t){console.error("Failed to submit form:",t)}finally{d.value=!1}},E=()=>{_.go(-1)};return R(()=>{u.value&&C()}),(t,a)=>{const n=O,r=P,v=T,B=j,F=A;return x(),q("div",z,[m("div",G,[m("h2",H,k(u.value?"编辑客户":"新建客户"),1)]),m("div",J,[D((x(),L(B,{ref_key:"formRef",ref:p,model:e,rules:w,"label-width":"100px"},{default:s(()=>[l(r,{label:"客户名称",prop:"name"},{default:s(()=>[l(n,{modelValue:e.name,"onUpdate:modelValue":a[0]||(a[0]=o=>e.name=o),placeholder:"请输入客户名称"},null,8,["modelValue"])]),_:1}),l(r,{label:"联系人",prop:"contact_person"},{default:s(()=>[l(n,{modelValue:e.contact_person,"onUpdate:modelValue":a[1]||(a[1]=o=>e.contact_person=o),placeholder:"请输入联系人姓名"},null,8,["modelValue"])]),_:1}),l(r,{label:"电话",prop:"phone"},{default:s(()=>[l(n,{modelValue:e.phone,"onUpdate:modelValue":a[2]||(a[2]=o=>e.phone=o),placeholder:"请输入联系电话"},null,8,["modelValue"])]),_:1}),l(r,{label:"邮箱",prop:"email"},{default:s(()=>[l(n,{modelValue:e.email,"onUpdate:modelValue":a[3]||(a[3]=o=>e.email=o),placeholder:"请输入邮箱地址"},null,8,["modelValue"])]),_:1}),l(r,{label:"地址",prop:"address"},{default:s(()=>[l(n,{modelValue:e.address,"onUpdate:modelValue":a[4]||(a[4]=o=>e.address=o),type:"textarea",rows:3,placeholder:"请输入详细地址"},null,8,["modelValue"])]),_:1}),l(r,{label:"税号",prop:"tax_number"},{default:s(()=>[l(n,{modelValue:e.tax_number,"onUpdate:modelValue":a[5]||(a[5]=o=>e.tax_number=o),placeholder:"请输入税务登记号"},null,8,["modelValue"])]),_:1}),l(r,{label:"银行账户",prop:"bank_account"},{default:s(()=>[l(n,{modelValue:e.bank_account,"onUpdate:modelValue":a[6]||(a[6]=o=>e.bank_account=o),placeholder:"请输入银行账户"},null,8,["modelValue"])]),_:1}),l(r,{label:"开户银行",prop:"bank_name"},{default:s(()=>[l(n,{modelValue:e.bank_name,"onUpdate:modelValue":a[7]||(a[7]=o=>e.bank_name=o),placeholder:"请输入开户银行"},null,8,["modelValue"])]),_:1}),l(r,{label:"备注",prop:"notes"},{default:s(()=>[l(n,{modelValue:e.notes,"onUpdate:modelValue":a[8]||(a[8]=o=>e.notes=o),type:"textarea",rows:4,placeholder:"请输入备注信息"},null,8,["modelValue"])]),_:1}),m("div",K,[l(v,{onClick:E},{default:s(()=>a[9]||(a[9]=[h("取消")])),_:1,__:[9]}),l(v,{type:"primary",loading:d.value,onClick:U},{default:s(()=>[h(k(d.value?"保存中...":"保存"),1)]),_:1},8,["loading"])])]),_:1},8,["model"])),[[F,i.value]])])])}}});export{ae as default};
