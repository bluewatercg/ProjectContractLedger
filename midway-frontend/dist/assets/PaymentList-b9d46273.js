/* empty css                  *//* empty css                   *//* empty css                      *//* empty css               *//* empty css                  *//* empty css                     *//* empty css                 *//* empty css                        *//* empty css                    */import"./el-tooltip-4ed993c7.js";import{d as j,r as s,o as A,c as Q,b as c,e as a,w as o,N as q,L as G,h as H,z as J,v as K,Q as W,R as X,S as Y,P as Z,l as w,g as i,t as y,y as ee,n as te,F as ae,T as ne,U as oe,O as le}from"./index-3fea3ed3.js";import{p as P}from"./payment-14150135.js";import{I as se}from"./InvoiceSelect-23496558.js";import{_ as ie}from"./_plugin-vue_export-helper-c27b6911.js";import"./invoice-99a4b4d9.js";const re={class:"page-container"},pe={class:"page-header"},ce={class:"table-container"},ue={class:"table-toolbar"},de={class:"table-search"},me={class:"pagination-container"},_e=j({__name:"PaymentList",setup(ve){const f=H(),_=s(!1),h=s([]),u=s(null),v=s(""),r=s(1),g=s(10),b=s(0),x=t=>new Intl.NumberFormat("zh-CN").format(t),z=t=>({cash:"现金",bank_transfer:"银行转账",check:"支票",credit_card:"信用卡",other:"其他"})[t]||t,k=t=>({pending:"warning",completed:"success",failed:"danger"})[t]||"info",E=t=>({pending:"待处理",completed:"已完成",failed:"失败"})[t]||t,p=async()=>{try{_.value=!0;const t=await P.getPayments({page:r.value,limit:g.value,invoiceId:u.value||void 0,status:v.value});t.success&&t.data&&(h.value=t.data.items,b.value=t.data.total)}catch(t){console.error("Failed to fetch payments:",t)}finally{_.value=!1}},M=(t,e)=>{u.value=t,r.value=1,p()},S=()=>{r.value=1,p()},T=()=>{r.value=1,p()},V=()=>{p()},B=t=>{f.push(`/payments/${t}`)},F=t=>{f.push(`/payments/${t}/edit`)},I=async t=>{try{await ee.confirm("确定要删除这条支付记录吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),(await P.deletePayment(t)).success&&(te.success("删除成功"),p())}catch(e){e!=="cancel"&&console.error("Failed to delete payment:",e)}};return A(()=>{p()}),(t,e)=>{const $=J("Plus"),N=ae,d=K,m=ne,L=W,l=oe,U=le,D=X,O=Y,R=Z;return w(),Q("div",re,[c("div",pe,[e[6]||(e[6]=c("h2",{class:"page-title"},"支付管理",-1)),a(d,{type:"primary",onClick:e[0]||(e[0]=n=>t.$router.push("/payments/create"))},{default:o(()=>[a(N,null,{default:o(()=>[a($)]),_:1}),e[5]||(e[5]=i(" 新建支付 "))]),_:1,__:[5]})]),c("div",ce,[c("div",ue,[c("div",de,[a(se,{modelValue:u.value,"onUpdate:modelValue":e[1]||(e[1]=n=>u.value=n),placeholder:"选择发票筛选（支持搜索）",width:"250px",onChange:M},null,8,["modelValue"]),a(L,{modelValue:v.value,"onUpdate:modelValue":e[2]||(e[2]=n=>v.value=n),placeholder:"状态筛选",style:{width:"120px"},onChange:S},{default:o(()=>[a(m,{label:"全部",value:""}),a(m,{label:"待处理",value:"pending"}),a(m,{label:"已完成",value:"completed"}),a(m,{label:"失败",value:"failed"})]),_:1},8,["modelValue"])])]),q((w(),G(D,{data:h.value,style:{width:"100%"}},{default:o(()=>[a(l,{prop:"id",label:"支付ID",width:"80"}),a(l,{prop:"invoice.invoice_number",label:"发票编号",width:"150"}),a(l,{prop:"invoice.contract.customer.name",label:"客户名称"}),a(l,{prop:"amount",label:"支付金额",width:"120"},{default:o(({row:n})=>[i(" ¥"+y(x(n.amount)),1)]),_:1}),a(l,{prop:"payment_date",label:"支付日期",width:"120"}),a(l,{prop:"payment_method",label:"支付方式",width:"120"},{default:o(({row:n})=>[i(y(z(n.payment_method)),1)]),_:1}),a(l,{prop:"reference_number",label:"参考号",width:"150"}),a(l,{prop:"status",label:"状态",width:"100"},{default:o(({row:n})=>[a(U,{type:k(n.status)},{default:o(()=>[i(y(E(n.status)),1)]),_:2},1032,["type"])]),_:1}),a(l,{label:"操作",width:"200"},{default:o(({row:n})=>[a(d,{size:"small",onClick:C=>B(n.id)},{default:o(()=>e[7]||(e[7]=[i("查看")])),_:2,__:[7]},1032,["onClick"]),a(d,{size:"small",type:"primary",onClick:C=>F(n.id)},{default:o(()=>e[8]||(e[8]=[i("编辑")])),_:2,__:[8]},1032,["onClick"]),a(d,{size:"small",type:"danger",onClick:C=>I(n.id)},{default:o(()=>e[9]||(e[9]=[i("删除")])),_:2,__:[9]},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[R,_.value]]),c("div",me,[a(O,{"current-page":r.value,"onUpdate:currentPage":e[3]||(e[3]=n=>r.value=n),"page-size":g.value,"onUpdate:pageSize":e[4]||(e[4]=n=>g.value=n),total:b.value,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:T,onCurrentChange:V},null,8,["current-page","page-size","total"])])])])}}});const Ve=ie(_e,[["__scopeId","data-v-a6b54719"]]);export{Ve as default};
